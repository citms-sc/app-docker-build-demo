import{_ as $,q as M,r as c,v as z,x as D,o as b,c as E,y as I,u as e,j as w,w as U,b as V,z as T,a as u,A as N,f as W,d as F,l as L}from"./index-Db60hw1j.js";import{f,d as O}from"./utils-D7U1D1oO.js";import{a as R,b as S,c as X,d as A,e as G}from"./patientList-DSxicClR.js";import{$ as q}from"./message-nC9YhWMO.js";import"./request-bVzS5DRY.js";import"./message-mENv_vSG.js";const y=({empty:n=!1,prop:l="",fns:v=[],trigger:_=""})=>[{required:n,message:`${l||"该项"}不能为空!`,trigger:"onBlur"},{trigger:["change","onBlur"],validator:function(i){if(v){for(const x of v)if(!x.validator(i))return this.message=x.message,x.validator(i)}}}],H={validator:n=>/^[\u4e00-\u9fa5]{2,50}$/.test(n),message:"请输入正确姓名"},J={validator:n=>/([1-9]\d{5})(\d{4})(\d{2})(\d{2})(\d{3})(\d|X)$/.test(n),message:"请输入正确身份证号"},K={validator:n=>/^((\(\d{3}\))|(\d{3}\-))?13[0-9]\d{8}|15[89]\d{8}/.test(n),message:"请输入正确电话"},Q=[{text:"男",value:"男"},{text:"女",value:"女"}],Y=[{text:"汉族",value:"汉族"},{text:"蒙古族",value:"蒙古族"},{text:"回族",value:"回族"},{text:"藏族",value:"藏族"},{text:"维吾尔族",value:"维吾尔族"},{text:"苗族",value:"苗族"},{text:"彝族",value:"彝族"},{text:"壮族",value:"壮族"},{text:"布依族",value:"布依族"},{text:"朝鲜族",value:"朝鲜族"},{text:"满族",value:"满族"},{text:"侗族",value:"侗族"},{text:"瑶族",value:"瑶族"},{text:"白族",value:"白族"},{text:"土家族",value:"土家族"},{text:"哈尼族",value:"哈尼族"},{text:"哈萨克族",value:"哈萨克族"},{text:"傣族",value:"傣族"},{text:"黎族",value:"黎族"},{text:"傈僳族",value:"傈僳族"},{text:"佤族",value:"佤族"},{text:"畲族",value:"畲族"},{text:"高山族",value:"高山族"},{text:"拉祜族",value:"拉祜族"},{text:"水族",value:"水族"},{text:"东乡族",value:"东乡族"},{text:"纳西族",value:"纳西族"},{text:"景颇族",value:"景颇族"},{text:"柯尔克孜族",value:"柯尔克孜族"},{text:"土族",value:"土族"},{text:"达斡尔族",value:"达斡尔族"},{text:"仫佬族",value:"仫佬族"},{text:"羌族",value:"羌族"},{text:"布朗族",value:"布朗族"},{text:"撒拉族",value:"撒拉族"},{text:"毛难族",value:"毛难族"},{text:"仡佬族",value:"仡佬族"},{text:"锡伯族",value:"锡伯族"},{text:"阿昌族",value:"阿昌族"},{text:"普米族",value:"普米族"},{text:"塔吉克族",value:"塔吉克族"},{text:"怒族",value:"怒族"},{text:"乌孜别克族",value:"乌孜别克族"},{text:"俄罗斯族",value:"俄罗斯族"},{text:"鄂温克族",value:"鄂温克族"},{text:"崩龙族",value:"崩龙族"},{text:"保安族",value:"保安族"},{text:"裕固族",value:"裕固族"},{text:"京族",value:"京族"},{text:"塔塔尔族",value:"塔塔尔族"},{text:"独龙族",value:"独龙族"},{text:"鄂伦春族",value:"鄂伦春族"},{text:"赫哲族",value:"赫哲族"},{text:"门巴族",value:"门巴族"},{text:"珞巴族",value:"珞巴族"},{text:"基诺族",value:"基诺族"}],Z=[{text:"未知",value:"未知"},{text:"绿",value:"绿"},{text:"黄",value:"黄"},{text:"红",value:"红"}],ee=[{text:"已婚",value:"已婚"},{text:"离婚",value:"离婚"},{text:"单身",value:"单身"},{text:"单身",value:"单身"},{text:"丧偶",value:"丧偶"},{text:"未知",value:"未知"}],te=[{text:"未知",value:"未知"},{text:"1型",value:"1型"},{text:"2型",value:"2型"}],le={class:"submit"},ae={__name:"addPatient",setup(n){M();let l=c({name:"",idcard:"",sex:"",nation:"",type:"",marital_status:"",height:NaN,weight:NaN,addr:"",tel:"",level:"",joined_at:"",confirmed_at:"",org_id:"",worker_id:""}),v=c([]),_=c([]),i=c(!1);const x=()=>{let s={...l.value,height:Number(l.value.height),weight:Number(l.value.weight)};i.value?(s.id=k.query.id,f(p,()=>R(s),t=>{q("修改成功!","success"),L.back()})):f(p,()=>S(s),t=>{q("添加成功!","success"),L.back()})};let r={name:y({empty:!0,prop:"姓名",fns:[H]}),idcard:y({empty:!0,prop:"身份证号",fns:[J]}),tel:y({empty:!0,prop:"电话",fns:[K]}),org:y({empty:!0,prop:"所属组织"})};const k=z(),B=async()=>{await f(p,()=>X({type:"tree"}),({data:t})=>{v.value=[];function o(d,g){d.forEach(m=>{m.type==="团队"?g.push({value:m.id,text:m.name}):m.subs&&m.subs.length>0&&o(m.subs,g)})}o(t,v.value)}),await h({page:1,page_size:1e3}),i.value=!!k.query.id,i.value&&C()},h=s=>f(p,()=>A(s),({data:t})=>{_.value=[],_.value=t.map(o=>({value:o.id,text:o.name}))});D(()=>l.value.org_id,(s,t)=>{l.value.worker_id="",h({page:1,page_size:1e3,org_id:s})});let p=c(!1);const C=()=>{let s={id:k.query.id};f(p,()=>G(s),({data:t})=>{t.org||(t.org={id:"",name:""}),t.worker||(t.worker={id:"",name:""}),l.value=O(t),l.value.org_id=t.org.id,l.value.worker_id=t.worker.id})};return B(),(s,t)=>{const o=V("van-field"),d=V("van-select"),g=V("van-datetime-picker"),m=V("van-button"),P=V("van-form"),j=T("loading");return b(),E("div",null,[I((b(),w(P,{ref:"form1"},{default:U(()=>[u(o,{modelValue:e(l).name,"onUpdate:modelValue":t[0]||(t[0]=a=>e(l).name=a),rules:e(r).name,label:"姓名",name:"name",placeholder:"请输入姓名",required:""},null,8,["modelValue","rules"]),u(d,{modelValue:e(l).sex,"onUpdate:modelValue":t[1]||(t[1]=a=>e(l).sex=a),columns:e(Q),rules:e(r).sex,label:"性别",name:"sex",placeholder:"请选择性别",required:""},null,8,["modelValue","columns","rules"]),u(o,{modelValue:e(l).idcard,"onUpdate:modelValue":t[2]||(t[2]=a=>e(l).idcard=a),rules:e(r).idcard,label:"身份证号",name:"idcard",placeholder:"请输入身份证号"},null,8,["modelValue","rules"]),u(d,{modelValue:e(l).nation,"onUpdate:modelValue":t[3]||(t[3]=a=>e(l).nation=a),columns:e(Y),rules:e(r).nation,label:"民族",name:"nation",placeholder:"请选择民族"},null,8,["modelValue","columns","rules"]),u(d,{modelValue:e(l).marital_status,"onUpdate:modelValue":t[4]||(t[4]=a=>e(l).marital_status=a),columns:e(ee),rules:e(r).marital_status,label:"婚姻状态",name:"marital_status",placeholder:"请选择婚姻状态"},null,8,["modelValue","columns","rules"]),u(o,{modelValue:e(l).height,"onUpdate:modelValue":t[5]||(t[5]=a=>e(l).height=a),rules:e(r).height,label:"身高（cm）",name:"height",placeholder:"请输入身高",required:"",type:"number"},null,8,["modelValue","rules"]),u(o,{modelValue:e(l).weight,"onUpdate:modelValue":t[6]||(t[6]=a=>e(l).weight=a),rules:e(r).weight,label:"体重（kg）",name:"weight",placeholder:"请输入体重",required:"",type:"number"},null,8,["modelValue","rules"]),u(o,{modelValue:e(l).addr,"onUpdate:modelValue":t[7]||(t[7]=a=>e(l).addr=a),rules:e(r).addr,label:"家庭住址",name:"addr",placeholder:"请输入家庭住址"},null,8,["modelValue","rules"]),u(o,{modelValue:e(l).tel,"onUpdate:modelValue":t[8]||(t[8]=a=>e(l).tel=a),rules:e(r).tel,label:"联系电话",name:"tel",placeholder:"请输入联系电话",type:"digit"},null,8,["modelValue","rules"]),u(d,{modelValue:e(l).level,"onUpdate:modelValue":t[9]||(t[9]=a=>e(l).level=a),columns:e(Z),rules:e(r).level,label:"病情分级",name:"level",placeholder:"请选择病人分级"},null,8,["modelValue","columns","rules"]),u(d,{modelValue:e(l).type,"onUpdate:modelValue":t[10]||(t[10]=a=>e(l).type=a),columns:e(te),rules:e(r).type,label:"分型",name:"type",placeholder:"请选择分型"},null,8,["modelValue","columns","rules"]),u(g,{modelValue:e(l).confirmed_at,"onUpdate:modelValue":t[11]||(t[11]=a=>e(l).confirmed_at=a),format:"yyyy-MM-dd",label:"确诊时间",name:"confirmed_at",placeholder:"请选择确诊时间"},null,8,["modelValue"]),u(g,{modelValue:e(l).joined_at,"onUpdate:modelValue":t[12]||(t[12]=a=>e(l).joined_at=a),modelModifiers:{async:!0},label:"入组时间",name:"joined_at",placeholder:"请选择入组时间"},null,8,["modelValue"]),e(i)?N("",!0):(b(),w(d,{key:0,modelValue:e(l).org_id,"onUpdate:modelValue":t[13]||(t[13]=a=>e(l).org_id=a),columns:e(v),label:"所属组织",name:"org_id",placeholder:"请输入所属组织"},null,8,["modelValue","columns"])),e(i)?N("",!0):(b(),w(d,{key:1,modelValue:e(l).worker_id,"onUpdate:modelValue":t[14]||(t[14]=a=>e(l).worker_id=a),columns:e(_),label:"所属医生",name:"worker_id",placeholder:"请输入所属医生"},null,8,["modelValue","columns"])),W("div",le,[u(m,{block:"","native-type":"submit",type:"primary",onClick:x},{default:U(()=>[F(" 提交 ")]),_:1})])]),_:1})),[[j,e(p)]])])}}},ie=$(ae,[["__scopeId","data-v-2113a23f"]]);export{ie as default};
